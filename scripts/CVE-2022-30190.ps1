# CVE-2022-30190 (Follina) Mitigation Script
# Disables the MSDT URL protocol handler

Write-Host "Applying mitigation for CVE-2022-30190 (Follina)..."

$msdtKey = "HKCR:\ms-msdt"
if (Test-Path $msdtKey) {
    Rename-Item -Path $msdtKey -NewName "ms-msdt-backup"
    Write-Host "MSDT protocol handler disabled successfully."
} else {
    Write-Host "MSDT protocol handler not found or already mitigated."
}
