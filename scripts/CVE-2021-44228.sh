#!/bin/bash
# CVE-2021-44228 - Log4Shell detection script

echo "[*] Scanning system for vulnerable Log4j JARs..."
find / -type f -name "log4j-core-*.jar" 2>/dev/null | while read -r file; do
  version=$(echo "$file" | grep -oP 'log4j-core-\K[0-9\.]+(?=\.jar)')
  if [[ "$version" < "2.15.0" ]]; then
    echo "[!] Vulnerable Log4j file found: $file (version $version)"
  fi
done

echo "[*] Scan complete. Review above paths and remove manually or automate cleanup."
